function Todo(a){"undefined"==typeof a&&(a=""),this.id=Math.random().toString(36).substring(7),this.name=a,this.created=Date.now(),this.done=!1,this.completed=null}var _88=_88||{};_88.util={getSelectedText:function(){var a="";return window.getSelection?a=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(a=document.selection.createRange().text),a}};var storageArea=chrome.storage.sync;angular.module("storage.service",[]).service("storageService",function(){var a=this;this.debug=!1,this.listen=function(b){chrome.storage.onChanged.addListener(function(c,d){if(b(c),a.debug)for(var e in c){var f=c[e];console.debug('Storage key "%s" in namespace "%s" changed. Old value was "%s", new value is "%s".',e,d,f.oldValue,f.newValue)}})},this.get=function(b,c){storageArea.get(b,function(b){c(b),a.debug&&(console.debug("Items returned from storage: "),console.debug(b))})},this.set=function(b,c){storageArea.set(b,c),a.debug&&(console.debug("Items sent to storage: "),console.debug(b))},this.clear=function(){storageArea.clear(null),a.debug&&console.debug("Storage cleared")}}),angular.module("todo.service",["storage.service"]).service("todoService",["storageService",function(a){console.log("Initialized todoService"),this.todos=[];var b=this;this.load=function(b){a.get(["todos"],function(a){console.log("todos.loaded"),(void 0===a.todos||null===a.todos)&&(a.todos=[new Todo("Start your list here..."),new Todo("Learn about the Markdown syntax: https://help.github.com/articles/markdown-basics/"),new Todo("Toggle *Markdown Preview* by pressing `Ctrl + M`"),new Todo("Cross this item off by pressing `Ctrl + D`"),new Todo("Delete a list item with `Esc`")]),console.log(a.todos),b(a.todos)})},this.save=function(){a.set({todos:b.todos},function(){console.log("todos.saved")})},this.addTodo=function(a){var c=new Todo;return a>=0?b.todos.splice(a,0,c):(b.todos.push(c),console.log("todo.added")),console.log("todo.added "+c.id),{todos:b.todos}},this.removeTodo=function(a){return _.remove(b.todos,{id:a}),console.log("todo.removed "+a),b.save(),b.todos},this.reset=function(){storageservice.clear()}}]),angular.module("todo.directive",[]).directive("todo",["$rootScope",function(a){return function(b,c,d){c.bind("keydown",function(b){var c=$(this).val();if(13===b.which){b.preventDefault();var e=$(this).closest("li").index(),f=$(this)[0].selectionStart;0===f&&(d.id=$(this).closest("li").prev().children(".todo").attr("id"),e--),console.log("itemIndex: "+e),a.$broadcast("ENTER_PRESSED",{atIndex:e+1}),$(".todo-list li").eq(e+1).find(".todo").focus()}else if(27===b.which)b.preventDefault(),$(this).closest("li").prev().find(".todo").focus(),a.$broadcast("REMOVE_TODO",{todo:d.id});else if(8===b.which)""===$(this).val()&&(b.preventDefault(),$(this).closest("li").prev().find(".todo").focus(),a.$broadcast("REMOVE_TODO",{todo:d.id}));else if(38===b.which)b.preventDefault(),$(this).closest("li").prev().find(".todo").focus();else if(40===b.which)b.preventDefault(),$(this).closest("li").next().find(".todo").focus();else if(b.ctrlKey&&66===b.which){b.preventDefault();var g=$(this)[0],h=g.selectionStart,i=g.selectionEnd;if(h===i)return;"**"===c.substring(h,h+2)&&"**"===c.substring(i-2,i)?($(this).val(c.substring(0,h)+c.substring(h+2,i-2)+c.substring(i)),g.selectionStart=h,g.selectionEnd=i-4):($(this).val(c.substring(0,h)+"**"+c.substring(h,i)+"**"+c.substring(i)),g.selectionStart=h,g.selectionEnd=i+4),$(this).trigger("change")}else if(b.ctrlKey&&68===b.which){b.preventDefault();var j=c.match(/^~~(.*)~~$/);$(this).val(j?j[1]:"~~"+c.replace(/~~/gi,"")+"~~"),$(this).trigger("change")}})}}]),angular.module("todo.filter",[]).filter("renderMarkdown",function(){return function(a){a=a||"";var b="";return b=marked(a)}}),angular.module("todo",["todo.service","todo.directive","todo.filter"]);